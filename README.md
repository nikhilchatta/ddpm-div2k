


# Denoising Diffusion Probabilistic Model (DDPM) - CIFAR-10

This repository contains the implementation of a **Denoising Diffusion Probabilistic Model (DDPM)** trained on the **CIFAR-10 dataset** for image generation tasks.

---

## 📌 Overview

DDPMs are a class of generative models that learn to reverse a diffusion process — starting from pure noise to a coherent image. This project follows the standard DDPM framework and demonstrates how such models can be effectively trained and evaluated on small image datasets like CIFAR-10.

---

## 📂 Repository Structure

```
├── Checkpoints/                  # Saved model checkpoints (.pt)
├── CIFAR10/                     # Dataset or tarball (Git LFS tracked)
├── data/                        # Additional datasets or support files
├── src/                         # Core implementation code (diffusion model, sampling, training, etc.)
├── metrics/                     # Code to compute LPIPS, FID, IS, KID, etc.
├── notebooks/                   # Jupyter notebooks for experiments and visualization
├── final.ipynb                  # Final experiment notebook
├── MyNotebook.ipynb             # Notebook added from Google Colab
├── .gitattributes               # Git LFS tracking config
├── requirements.txt             # Project dependencies
└── README.md                    # Project overview (this file)
```

---

## 🚀 Getting Started

### 1️⃣ Clone the Repository
```bash
git clone git@github.com:nikhilchatta/DDPM-CIFAR10-Clean.git
cd DDPM-CIFAR10-Clean
```

### 2️⃣ Install Dependencies
```bash
pip install -r requirements.txt
```

### 3️⃣ Setup Git LFS (if not done already)
```bash
git lfs install
```

---

## 📊 Evaluation Metrics

To evaluate the quality, diversity, and realism of images generated by the DDPM model, we implemented the following standard and custom evaluation metrics:

### 🔸 LPIPS (Learned Perceptual Image Patch Similarity)
- Measures perceptual similarity between generated and real images using deep features (e.g., VGG or AlexNet).
- Lower LPIPS scores indicate better visual similarity and realism.
- Reflects human visual perception better than pixel-wise metrics.

### 🔸 FID (Fréchet Inception Distance)
- Measures the distance between distributions of real and generated images in the feature space of a pre-trained Inception network.
- Lower FID indicates higher fidelity and quality.
- Robust metric widely used in GANs and diffusion models.

### 🔸 IS (Inception Score)
- Evaluates both the quality and diversity of generated images using Inception predictions.
- Higher IS indicates that images are both classifiable and diverse.
- Sensitive to class imbalances and overfitting.

### 🔸 KID (Kernel Inception Distance)
- Similar to FID but based on MMD with polynomial kernel.
- Unlike FID, KID provides unbiased estimators even on small datasets.
- Lower KID score means better quality and diversity.

### 🔸 SSIM (Structural Similarity Index)
- Measures structural similarity between real and generated images.
- Score ranges from -1 to 1 (1 = perfect similarity).
- Captures changes in luminance, contrast, and structure.

### 🔸 PSNR (Peak Signal-to-Noise Ratio)
- Measures pixel-level reconstruction quality.
- Common in image restoration tasks.
- Higher PSNR indicates better image fidelity (less noise).

### 🔸 MSE (Mean Squared Error)
- Pixel-wise error between real and generated images.
- Simple but often used for quantitative comparison.
- Lower MSE indicates better accuracy.

### 🔸 Diversity Score
- Custom metric to assess intra-batch variability of generated images.
- Measures pixel-wise variance or feature-space diversity across generated samples.
- Higher diversity score indicates a richer and more varied generation capability.


---

### 📎 Metrics Summary Table

| Metric          | Type           | Range       | Ideal Value     |
|------------------|----------------|-------------|------------------|
| LPIPS            | Perceptual     | 0 to 1+     | Lower Better     |
| FID              | Distributional | 0 to ∞      | Lower Better     |
| IS               | Classification | >1          | Higher Better    |
| KID              | Distributional | 0 to 1      | Lower Better     |
| SSIM             | Structural     | -1 to 1     | Higher Better    |
| PSNR             | Pixel Accuracy | 0 to ∞ dB   | Higher Better    |
| MSE              | Pixel Error    | 0 to ∞      | Lower Better     |
| Diversity Score  | Custom         | 0 to ∞      | Higher Better    |

---

## 📸 Sampling

After training, use the sampling script to generate new images:

```bash
python src/sample.py --checkpoint Checkpoints/final_model.pt
```

---

## 📬 Contact

For queries or collaborations: **nikhilchatta@gmail.com [at] github**
```

---
